### 说明

验证io channel先创建连接，后启动对方的服务，再调用rpc接口（在发送前可以添加判断是否连接），是否可行（**验证通过**），步骤：

- 客户端创建和服务器的IO连接，休眠一段时间；
- 启动grpc服务；
- client调用rpc接口；

## 编译
进入测试目录`channel-sdk/test/c++/one_to_one`，然后执行；

### 创建编译目录

```bash
mkdir build && cd build
```

### 编译选项说明

注意：编译选项可组合使用；

- 指定服务器类型

  包括异步和同步两种类型；

  ```bash
  cmake -DASYNC_SERVER=1 ..
  ```

  > 说明：
  >
  > - ASYNC_SERVER=1表示使用异步服务器；
  > - 不指定时（默认）表示使用同步服务器；



- 指定客户端类型

  包括异步和同步两种类型；

  ```bash
  cmake -DASYNC_CLIENT=1 .. 
  ```

  > 说明：
  >
  > - ASYNC_CLIENT=1表示使用异步客户端（不需要等待服务器的响应，直接返回）；
  > - 不指定时（默认）表示使用同步客户端；



### 执行编译

```bash
make
```

> 编译成功后在build目录下生成so文件，包括io库`libexternal_io.so`和p0_server，p1_client可执行文件；



## 测试步骤

### 开始测试

- 启动客户端

  ```bash
  ./p1_client
  ```
  > 启动客户端后，客户端会向服务器发送数据，默认超时时间为15000ms，即15s, 超过此时间启动服务器，此数据会发送失败，丢失此数据包；

- 启动服务器

  ```bash
  ./p0_server
  ```
  > 在客户端发送第一条数据超时后，开始第二条数据时，启动服务器，服务器在启动成功后，客户端随即发送数据到服务器上，服务器接收数据成功。

### 外部断开连接测试
当客户端和服务器正常通讯过程中，使用外部方式断开连接，测试客户端是否可以重新连接服务器，并且数据不会丢失；
